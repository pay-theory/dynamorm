# DynamORM v1.0.9 - Performance Improvements & API Refinements

## Overview

DynamORM v1.0.9 delivers significant performance improvements, achieving near-parity with direct AWS SDK calls while maintaining the elegant, type-safe API you love. This release also includes important API refinements based on user feedback.

## Key Improvements

### ðŸš€ Performance Enhancements

**Primary Key Query Optimization**
- Fixed primary key recognition to properly use `GetItem` instead of `Query`
- **Result**: ~5x performance improvement for single item lookups
- Reduced from 2.5ms to 0.52ms per operation (nearly matching AWS SDK's 0.51ms)

**Memory Efficiency**
- Optimized internal structures and reduced allocations
- **77% reduction** in memory usage (from 179KB to 42KB per operation)
- **77% fewer** allocations (from 2,416 to 566 per operation)

### ðŸ“Š Benchmark Results

| Operation | v1.0.8 | v1.0.9 | AWS SDK | Improvement |
|-----------|--------|--------|---------|-------------|
| Single Lookup | 2,566,280 ns/op | 519,986 ns/op | 513,437 ns/op | **4.9x faster** |
| Memory Usage | 179,285 B/op | 41,913 B/op | 40,910 B/op | **77% less** |
| Allocations | 2,416 allocs/op | 566 allocs/op | 559 allocs/op | **77% fewer** |

### ðŸ”§ API Refinements

**Query Method Signatures**
- `Where()` consistently uses 3 parameters: `(field, operator, value)`
- Supported operators: `=`, `!=`, `>`, `<`, `>=`, `<=`, `BETWEEN`, `IN`, `BEGINS_WITH`, `CONTAINS`, `EXISTS`, `NOT_EXISTS`

**Result Retrieval**
- `All(&results)` - Get all matching items
- `First(&result)` - Get first matching item
- `Count()` - Count matching items
- Removed deprecated `Find()` method

**Index Queries**
```go
// Correct v1.0.9 syntax
db.Model(&Item{}).
    Index("gsi-name").
    Where("field", "=", value).
    All(&results)
```

## Migration Guide

### Updating Your Code

Most code will work without changes. Key updates:

1. **Where Clauses** - Already use 3 parameters in most cases
2. **Find() â†’ All()** - Replace any `Find(&results)` with `All(&results)`
3. **First()** - Ensure you pass destination: `First(&result)`

### Examples

**Before (v1.0.8)**
```go
// If you had custom patterns
db.Query("index-name").Where("field", value).Find(&results)
```

**After (v1.0.9)**
```go
// Standard pattern
db.Model(&Type{}).
    Index("index-name").
    Where("field", "=", value).
    All(&results)
```

## Bug Fixes

- Fixed primary key recognition for DynamoDB attribute names vs Go field names
- Resolved index query compilation issues
- Corrected field mapping for models with custom attribute names
- Improved error messages for better debugging

## Installation

```bash
go get -u github.com/pay-theory/dynamorm@v1.0.9
```

## What's Next

- v1.1.0 will introduce single table design utilities
- Enhanced batch operation performance
- Additional index selection optimizations

## Credits

Special thanks to the community for performance testing and feedback that made these improvements possible. 