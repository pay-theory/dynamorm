# Release Notes: v1.0.3 - Core Implementation Complete

## Overview

Version 1.0.3 completes the implementation of all core DynamoDB operations that were previously returning placeholder errors. This release delivers full functionality for batch operations, update builders, and query execution, making DynamORM feature-complete for production use.

## Key Features

### 1. Complete Batch Operations

All batch operation methods now have full implementations:

```go
// Delete multiple items efficiently
err := db.Model(&User{}).BatchDelete([]any{
    map[string]any{"pk": "user123"},
    map[string]any{"pk": "user456", "sk": "profile"},
})

// Mixed batch operations - puts and deletes in one request
err := db.Model(&User{}).BatchWrite(
    []any{newUser1, newUser2},              // Items to put
    []any{"keyToDelete1", "keyToDelete2"},  // Keys to delete
)

// Batch updates with options
err := db.Model(&User{}).BatchUpdateWithOptions(
    users,                    // Items to update
    []string{"Status"},       // Fields to update
    WithCondition("version", "=", 1),
)
```

### 2. Functional Update Builder

The `UpdateBuilder()` method now returns a fully functional builder with fluent API:

```go
err := db.Model(&user).
    Where("id", "=", userId).
    UpdateBuilder().
    Set("name", "New Name").
    Add("loginCount", 1).
    AppendToList("tags", []string{"new-tag"}).
    ConditionVersion(currentVersion).
    Execute()
```

Supported operations:
- `Set(field, value)` - Set field to value
- `Add(field, value)` - Add numeric value (increment/decrement)
- `Remove(field)` - Remove a field
- `Delete(field, value)` - Delete from set
- `AppendToList(field, values)` - Append to list
- `PrependToList(field, values)` - Prepend to list
- `RemoveFromListAt(field, index)` - Remove list element
- `SetListElement(field, index, value)` - Update list element
- Conditional operations with `Condition()`, `ConditionExists()`, `ConditionNotExists()`, `ConditionVersion()`

### 3. Complete Query Executor Implementation

The query executor now fully implements:
- `ExecuteQuery` with key conditions, filters, projections, and pagination
- `ExecuteScan` with parallel scan support and filtering
- `ExecuteQueryWithPagination` and `ExecuteScanWithPagination` for cursor-based pagination
- `ExecuteBatchGet` and `ExecuteBatchWrite` with automatic retry for unprocessed items

## Breaking Changes

None. All changes are backward compatible - methods that previously returned "not implemented" errors now function correctly.

## Bug Fixes

- Fixed circular dependencies between core and query packages
- Resolved interface signature mismatches for `BatchUpdateWithOptions`
- Added missing mock implementations for new batch methods
- Fixed stress test compilation errors
- Corrected all staticcheck warnings

## Code Quality Improvements

- Removed unused types that were duplicating functionality:
  - `executor` type and methods (reimplemented in proper location)
  - `metadataAdapter` type (functionality integrated elsewhere)
  - `filter` struct (using expression builder instead)
- Fixed Go convention violations (error string capitalization)
- Cleaned up unnecessary code patterns

## Migration Guide

No migration required. Simply update to v1.0.3 to gain access to the complete implementations:

```bash
go get -u github.com/pay-theory/dynamorm@v1.0.3
```

## Testing

All new implementations include comprehensive test coverage. Update your mocks if you were previously mocking these methods:

```go
// Example: Update mock for BatchWrite
mockQuery.On("BatchWrite", 
    mock.AnythingOfType("[]interface{}"), 
    mock.AnythingOfType("[]interface{}"),
).Return(nil)
```

## Performance Considerations

- Batch operations automatically handle DynamoDB's 25-item limit by chunking
- Unprocessed items are automatically retried
- Parallel scan operations distribute load across segments
- Update operations minimize data transfer with targeted field updates

## What's Next

With core functionality complete, future releases will focus on:
- Performance optimizations
- Enhanced error handling and debugging
- Additional helper methods for common patterns
- Improved documentation and examples

## Support

For questions or issues, please:
- Check the [documentation](https://github.com/pay-theory/dynamorm/tree/main/docs)
- Open an [issue](https://github.com/pay-theory/dynamorm/issues)
- See [examples](https://github.com/pay-theory/dynamorm/tree/main/examples) for usage patterns 